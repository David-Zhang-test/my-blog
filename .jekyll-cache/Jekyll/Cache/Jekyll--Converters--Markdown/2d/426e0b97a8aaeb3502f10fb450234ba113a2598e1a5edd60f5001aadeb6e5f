I"#ı<p><br /></p>

<h2 id="ä¸€é¡¹ç›®å‡†å¤‡">ä¸€ã€é¡¹ç›®å‡†å¤‡</h2>

<p><strong>è¯´æ˜ï¼å¿…çœ‹ï¼</strong></p>

<p><strong>è¿™ç¯‡æ–‡ç« æ˜¯TechniColorä¿±ä¹éƒ¨é«˜çº§ç»„çš„é¡¹ç›®æ•™ç¨‹ï¼Œæ˜¯å¯¹é¡¹ç›®çš„ä¸€ä¸ªæ€»ç»“ä¹Ÿå¸®åŠ©ä»¥åçš„åŒå­¦å­¦ä¹ </strong></p>

<p>å¦‚æœä½ ä¸æ˜¯æˆ‘ä»¬ä¿±ä¹éƒ¨çš„æˆå‘˜ä½†å¯¹æ—¥ç¨‹ç®¡ç†æ„Ÿå…´è¶£çš„è¯ï¼Œä¹Ÿå¯ä»¥çœ‹è¿™ä¸ªæ•™ç¨‹ï¼Œæ„Ÿè°¢æ”¯æŒ</p>

<p>é—²è¨€å°‘å™ï¼Œæˆ‘ä»¬è¿›å…¥æ­£é¢˜ï¼š</p>

<p>æ—¥ç¨‹ç®¡ç†æ˜¯æ¯ä¸ªäººéƒ½éœ€è¦åšçš„äº‹æƒ…ï¼Œä¸è®ºæ˜¯ç”¨å¥½è„‘å­è¿˜æ˜¯ç”¨çƒ‚ç¬”å¤´æŠ‘æˆ–æ˜¯ç¨‹åºéƒ½å¯ä»¥å®ç°ã€‚ç¨‹åºçš„ä¼˜ç‚¹åœ¨äºå®ƒå¾ˆæ¸…æ™°åŒæ—¶ä¹Ÿæ˜“äºè¿›è¡Œç»Ÿè®¡ï¼Œè¿˜å¯ä»¥é”»ç‚¼ä¸‹å†™pythonçš„èƒ½åŠ›ï¼Œ<del>è¿™æ‰æ˜¯ä¸»è¦ç›®çš„</del>ã€‚</p>

<p>åœ¨å¼€å§‹æ•²ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆçœ‹ä¸€ä¸‹è‡ªå·±éœ€è¦åšä»€ä¹ˆã€‚ä¸ºäº†æ›´å¥½å¾—æ•´ç†æ€è·¯ï¼Œæˆ‘é€‰æ‹©ä½¿ç”¨æ€ç»´å¯¼å›¾çš„æ–¹å¼ã€‚</p>

<p><br /></p>

<p><img src="../images/2021-01-05-event-management/mindmap.png" alt="img" /></p>

<p><br /></p>

<p><strong>åœ¨ç¡®å®šå¥½æˆ‘ä»¬éœ€è¦åšä»€ä¹ˆä¹‹åï¼Œå°±å¯ä»¥ç€æ‰‹å­¦ä¹ æ•²ä»£ç äº†ï¼</strong></p>

<h2 id="äºŒå¿…å¤‡çŸ¥è¯†">äºŒã€å¿…å¤‡çŸ¥è¯†ï¼š</h2>

<h3 id="1å¦‚æœä½ åªæƒ³äº†è§£ç¨‹åºé€»è¾‘ä½ å¯ä»¥é€‰æ‹©è·³è¿‡è¿™éƒ¨åˆ†çŸ¥è¯†ç›´æ¥åˆ°ç¬¬äºŒéƒ¨åˆ†">1.<strong>å¦‚æœä½ åªæƒ³äº†è§£ç¨‹åºé€»è¾‘</strong>ï¼Œä½ å¯ä»¥é€‰æ‹©è·³è¿‡è¿™éƒ¨åˆ†çŸ¥è¯†ï¼Œç›´æ¥åˆ°ç¬¬äºŒéƒ¨åˆ†</h3>

<h3 id="2pythonçš„å®‰è£…ä¸å¸è½½">2.pythonçš„å®‰è£…<del>ä¸å¸è½½</del></h3>

<p>è¯·çœ‹<a href="https://www.liaoxuefeng.com/wiki/1016959663602400/1016959856222624">è¿™ç¯‡æ–‡ç« </a></p>

<h3 id="3pythonçš„åŸºç¡€çŸ¥è¯†">3.pythonçš„åŸºç¡€çŸ¥è¯†</h3>

<p>ä½ éœ€è¦æŒæ¡pythonçš„åŸºæœ¬è¯­æ³•ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºæ•°æ®ç±»å‹ï¼Œå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œè¿ç®—ç¬¦ï¼Œå˜é‡ï¼Œå­—ç¬¦ä¸²ï¼Œæ•°ç»„ï¼Œå­—å…¸ï¼Œå‡½æ•°ï¼Œæ–‡ä»¶è¯»å–ï¼Œé€‰æ‹©ç»“æ„ï¼Œå¾ªç¯ç»“æ„ç­‰ç­‰</p>

<p>å¦‚æœä½ éƒ½ä¸äº†è§£ï¼Œ<del>å‘ç°è‡ªå·±æ˜¯ä¸ªåºŸç‰©ï¼Œå»ºè®®é©¬ä¸Šå…³æ‰è¿™ç¯‡æ–‡ç« </del>å»ºè®®é©¬ä¸Šå­¦ä¹ ä¸€ä¸‹</p>

<p>æ¨èä½¿ç”¨çš„å­¦ä¹ ç½‘ç«™åŒ…æ‹¬ä½†ä¸é™äº</p>

<p><a href="https://www.runoob.com/python/python-tutorial.html">èœé¸Ÿæ•™ç¨‹</a>ï¼Œ<a href="https://www.liaoxuefeng.com/wiki/1016959663602400">å»–é›ªå³°pythonæ•™ç¨‹</a>ï¼Œ<a href="https://mofanpy.com/tutorials/python-basic/basic/">è«çƒ¦pythonåŸºç¡€æ•™ç¨‹</a>ç­‰ç­‰</p>

<p>äº’è”ç½‘æ—¶ä»£å­¦ä¹ ç¼–ç¨‹å¾ˆå¤§ç¨‹åº¦ä¸Šéœ€è¦è‡ªå­¦ï¼Œä¸°å¯Œçš„åœ¨çº¿èµ„æºä¸ºæ­¤æä¾›äº†é‡è¦çš„æ”¯æŒã€‚å°½ç®¡å¦‚æ­¤ï¼Œæœ‰è€å¸ˆæ•™å­¦å¤§å¤šæ•°æ—¶å€™éƒ½æ˜¯æ±‚ä¹‹ä¸å¾—çš„äº‹æƒ…ï¼Œè¯·åŒå­¦ä»¬çæƒœä½ çš„è€å¸ˆ<del>å’Œä»–ä»¬çš„å¤´å‘</del>ã€‚</p>

<h3 id="4tkinterçš„åŸºæœ¬çŸ¥è¯†">4.tkinterçš„åŸºæœ¬çŸ¥è¯†</h3>

<p>è¿™æ˜¯pythonè‡ªå¸¦çš„ä¸€ä¸ªå›¾å½¢åŒ–ï¼ˆGUIï¼‰åº“ï¼Œä½ å¯ä»¥ç”¨å®ƒå®Œæˆå¯¹ç”¨æˆ·çš„äº¤äº’ï¼Œä½ éœ€è¦å¯¹å®ƒ<strong>æœ‰ä¸€å®šçš„</strong>äº†è§£ã€‚</p>

<p><strong>ä½ å¯ä»¥</strong>é€šè¿‡<a href="https://www.runoob.com/python/python-gui-tkinter.html">è¿™ä¸ªç½‘ç«™</a>å­¦ä¹ å®ƒçš„åŸºæœ¬ç”¨æ³•ã€‚</p>

<p><strong>ä½ ä¹Ÿå¯ä»¥</strong>é€šè¿‡<a href="https://www.bilibili.com/video/BV1jW411Y7dL">è¿™ä¸ªè§†é¢‘</a>æ¥äº†è§£å¦‚ä½•ä½¿ç”¨tkinterã€‚</p>

<h2 id="ä¸‰å¼€å§‹">ä¸‰ã€å¼€å§‹</h2>

<p><strong>ä½ å¯ä»¥åœ¨<a href="https://github.com/David-Zhang-test/program_shareing">github</a>ä¸Šæ‰¾åˆ°æœ¬ç¯‡æ•™ç¨‹çš„å…¨éƒ¨ä»£ç ï¼Œç¼–å·ä¸º3-å°æ ‡é¢˜ã€‚ä¾‹å¦‚â€œ1.åˆå§‹åŒ–ä¸€ä¸ªtkinterçª—å£â€çš„ä»£ç å°±åœ¨æ–‡ä»¶3-1ä¸­ï¼Œå¦‚æœä½ æƒ³ç™½å«–ä»£ç çš„è¯ï¼Œå¯ä»¥ç›´æ¥æ‰¾åˆ°finalæ–‡ä»¶å¤¹ï¼Œä¸‹è½½åˆ°æœ¬åœ°å³å¯ã€‚</strong></p>

<p><strong>è¯·ä¸€å®šæ³¨æ„æŸ¥çœ‹æ³¨é‡Š</strong></p>

<h3 id="1åˆå§‹åŒ–ä¸€ä¸ªtkinterçª—å£">1.åˆå§‹åŒ–ä¸€ä¸ªtkinterçª—å£</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#å¯¼å…¥åº“
</span><span class="kn">import</span> <span class="nn">tkinter</span> <span class="k">as</span> <span class="n">tk</span>
<span class="c1">#åˆ›å»ºä¸€ä¸ªwindowå®ä¾‹
</span><span class="n">window</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Tk</span><span class="p">()</span>
<span class="n">window</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'æ—¥ç¨‹ç®¡ç†'</span><span class="p">)</span>
<span class="n">window</span><span class="p">.</span><span class="n">geometry</span><span class="p">(</span><span class="s">"400x300"</span><span class="p">)</span>
<span class="n">window</span><span class="p">.</span><span class="n">mainloop</span><span class="p">()</span>
</code></pre></div></div>

<p>è¿™äº›éƒ½æ˜¯æœ€åŸºæœ¬çš„è¯­æ³•äº†ã€‚</p>

<p>å…ˆå¯¼å…¥tkinteråº“ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªwindowå®ä¾‹ã€‚</p>

<p><strong>è¿è¡Œæ•ˆæœï¼š</strong></p>

<p><img src="../images/2021-01-05-event-management/3-1.png" alt="img" /></p>

<h3 id="2æŒ‰åŠŸèƒ½åˆ†ä¸ºä¸¤ä¸ªé¡µé¢">2.æŒ‰åŠŸèƒ½åˆ†ä¸ºä¸¤ä¸ªé¡µé¢</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#å¯¼å…¥åº“
</span><span class="kn">import</span> <span class="nn">tkinter</span> <span class="k">as</span> <span class="n">tk</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">ttk</span>
<span class="c1">#åˆ›å»ºä¸€ä¸ªwindowå®ä¾‹
</span><span class="n">window</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Tk</span><span class="p">()</span>
<span class="n">window</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'æ—¥ç¨‹ç®¡ç†'</span><span class="p">)</span>
<span class="n">window</span><span class="p">.</span><span class="n">geometry</span><span class="p">(</span><span class="s">"400x300"</span><span class="p">)</span>
<span class="c1">#åˆ†é¡µ
</span><span class="n">nb</span> <span class="o">=</span> <span class="n">ttk</span><span class="p">.</span><span class="n">Notebook</span><span class="p">(</span><span class="n">window</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">380</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mi">260</span><span class="p">)</span>
<span class="n">nb</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">tab1</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">nb</span><span class="p">)</span>
<span class="n">nb</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">tab1</span><span class="p">,</span><span class="n">text</span> <span class="o">=</span> <span class="s">"æ˜¾ç¤ºå¾…åŠ"</span><span class="p">)</span>
<span class="n">tab2</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">nb</span><span class="p">)</span>
<span class="n">nb</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">tab2</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s">"ç®¡ç†å¾…åŠ"</span><span class="p">)</span>

<span class="n">window</span><span class="p">.</span><span class="n">mainloop</span><span class="p">()</span>
</code></pre></div></div>

<p>ç”±äºå‰é¢æ€ç»´å¯¼å›¾é‡ŒæŠŠä¸»è¦ä»»åŠ¡åˆ†ä¸ºäº†æ˜¾ç¤ºå’Œç®¡ç†ï¼Œæ‰€ä»¥è¿™é‡ŒæŠŠä¸¤ä¸ªé¡µé¢åˆ†å¼€ã€‚</p>

<p>å…ˆå¯¼å…¥ttkåº“ï¼Œç„¶ååˆ›å»ºä¸¤ä¸ªNotebookå®ä¾‹ï¼Œè¿™æ ·å°±æŠŠä¸¤ä¸ªé¡µé¢åˆ†å¼€äº†ã€‚</p>

<p>è¿™é‡Œé¢ç”¨åˆ°äº†tkinterä¸‰ç§åŒ…è£…æ–¹å¼pack, grid, placeä¸­çš„gridï¼Œä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„ä¸€ç§ã€‚æœ‰å…³è¿™ä¸‰ç§åŒ…è£…æ–¹å¼çš„æ•™ç¨‹å¯ä»¥æŸ¥çœ‹<a href="https://blog.csdn.net/weixin_43118073/article/details/100077067?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-2.not_use_machine_learn_pai&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-2.not_use_machine_learn_pai">è¿™ä¸ªç½‘ç«™</a></p>

<p>Frameä¹Ÿæ˜¯tkinterçš„ç»„ä»¶ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå¸ƒç½®ç»„ä»¶çš„ç»„ä»¶ï¼ˆè€å¥—å¨ƒäº†ï¼‰ã€‚</p>

<p><strong>è¿è¡Œæ•ˆæœï¼š</strong></p>

<p><img src="../images/2021-01-05-event-management/3-2.png" alt="img" /></p>

<h3 id="3æ’å…¥æ·»åŠ å¾…åŠçš„ç»„ä»¶">3.æ’å…¥æ·»åŠ å¾…åŠçš„ç»„ä»¶</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">---</span>
<span class="c1">#åŸæœ‰å†…å®¹
</span><span class="n">nb</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">tab2</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s">"ç®¡ç†å¾…åŠ"</span><span class="p">)</span>
<span class="o">---</span>
<span class="c1">#æ–°å¢å†…å®¹
</span>

<span class="c1">#å¾…åŠç®¡ç†é¡µ
</span>
<span class="c1">#å¾…åŠåç§°è¾“å…¥æ¡†
</span><span class="n">l1</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Label</span><span class="p">(</span><span class="n">tab2</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">"å¾…åŠåç§°ï¼š"</span><span class="p">)</span>
<span class="n">l1</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">e1</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">tab2</span><span class="p">)</span><span class="c1">#å¯ä»¥ç”¨get()æ–¹æ³•è·å–è¾“å…¥çš„å†…å®¹
</span><span class="n">e1</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#è¯¦ç»†ä¿¡æ¯è¾“å…¥æ¡†
</span><span class="n">l2</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Label</span><span class="p">(</span><span class="n">tab2</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">"è¯¦ç»†ä¿¡æ¯ï¼š"</span><span class="p">)</span>
<span class="n">l2</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">e2</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">tab2</span><span class="p">)</span>
<span class="n">e2</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#ddlè¾“å…¥æ¡†
</span><span class="n">l6</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Label</span><span class="p">(</span><span class="n">tab2</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">"ddl:"</span><span class="p">)</span>
<span class="n">l6</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">e3</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">tab2</span><span class="p">)</span>
<span class="n">e3</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#æŒ‰é’®ï¼Œå¯ä»¥ç»‘å®šåŠŸèƒ½
</span><span class="n">b1</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Button</span><span class="p">(</span><span class="n">tab2</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">"æ·»åŠ å¾…åŠ"</span><span class="p">)</span><span class="c1">#æœªç»‘å®šçš„æŒ‰é’®
</span><span class="n">b1</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">columnspan</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>

<span class="o">---</span>
<span class="c1">#åŸæœ‰å†…å®¹
</span><span class="n">window</span><span class="p">.</span><span class="n">mainloop</span><span class="p">()</span>
</code></pre></div></div>

<p><strong>ä»£ç è¶Šæ¥è¶Šé•¿ï¼Œæˆ‘å°±åªæ˜¾ç¤ºå¢åŠ çš„éƒ¨åˆ†å’Œå‰åä¸¤è¡ŒåŸæœ‰ä»£ç äº†ï¼Œå¤åˆ¶æ—¶è¯·æŠŠå‰ååŸæœ‰å†…å®¹åˆ é™¤ã€‚</strong></p>

<p><strong>æˆ‘æ ‡æ³¨åŸæœ‰å†…å®¹çš„åœ°æ–¹å°±æ˜¯æ–°å¢å†…å®¹çš„ä¸Šä¸€è¡Œä»£ç ï¼Œæ–°ä»£ç ç›´æ¥æ¥åœ¨ä¸‹æ–¹å°±å¯ä»¥ã€‚</strong></p>

<p>Labelã€Entryå’ŒButtonéƒ½æ˜¯tkinterçš„ç»„ä»¶ã€‚åœ¨Labelä¸Šå¯ä»¥æ˜¾ç¤ºæ–‡å­—ï¼Œèµ·åˆ°æç¤ºåŠŸèƒ½ã€‚Entryæ˜¯è·å–ç”¨æˆ·è¾“å…¥æ–‡å­—çš„ç»„ä»¶ï¼Œå¯ä»¥ç”¨get()æ–¹æ³•è·å–è¾“å…¥å†…å®¹ã€‚</p>

<p>æŒ‰é’®æ˜¯ä¸€ä¸ªå¯ä»¥ç»‘å®šåŠŸèƒ½çš„ç»„ä»¶ï¼Œå¯ä»¥è‡ªå·±å†™ä¸€ä¸ªå‡½æ•°ï¼Œå½“ç‚¹å‡»æŒ‰é’®æ—¶æ‰§è¡Œã€‚è¿™é‡Œç”±äºè¿˜æ²¡æœ‰è®¾è®¡å‡½æ•°åŠŸèƒ½ï¼Œæ‰€ä»¥æŒ‰é’®è¿˜æ²¡æœ‰è¿›è¡Œç»‘å®šã€‚</p>

<p><strong>è¿è¡Œæ•ˆæœï¼š</strong></p>

<p><img src="../images/2021-01-05-event-management/3-3.png" alt="img" /></p>

<h3 id="4è®¾è®¡æ•°æ®è¡¨">4.è®¾è®¡æ•°æ®è¡¨</h3>

<p>åœ¨å‰é¢è€ƒè™‘æ•°æ®è¡¨çš„æ ¼å¼æ—¶ç”¨äº†æ€ç»´å¯¼å›¾çš„æ–¹å¼æ¥æ€»ç»“ï¼Œè¿™ä¸ªæ•°æ®è¡¨åº”è¯¥åŒ…æ‹¬</p>

<p><strong>å”¯ä¸€ç¡®å®šç¼–å·ï¼Œ</strong></p>

<p><strong>æ—¥ç¨‹æ¦‚è¦ï¼Œ</strong></p>

<p><strong>æ—¥ç¨‹ç»†èŠ‚ï¼Œ</strong></p>

<p><strong>ddlï¼Œ</strong></p>

<p><strong>æ’å…¥æ—¶é—´ï¼Œ</strong></p>

<p><strong>æ˜¯å¦æ˜¾ç¤ºåœ¨è¡¨æ ¼ä¸­</strong></p>

<p>æ³¨ï¼šè¡¨æ ¼çš„ç»˜åˆ¶ä¼šåœ¨åé¢ç¬¬6ç‚¹ä¼šè®²åˆ°ï¼Œè¡¨æ ¼æ˜¯æˆ‘ç”¨æ¥æ˜¾ç¤ºå¾…åŠçš„åœ°æ–¹ã€‚</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="nl">"0"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"</span><span class="se">\u</span><span class="s2">8bed</span><span class="se">\u</span><span class="s2">6587"</span><span class="p">,</span><span class="w"> </span><span class="nl">"details"</span><span class="p">:</span><span class="w"> </span><span class="s2">"</span><span class="se">\u</span><span class="s2">77ed</span><span class="se">\u</span><span class="s2">8bc4"</span><span class="p">,</span><span class="w"> </span><span class="nl">"ddl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-01-05"</span><span class="p">,</span><span class="w"> </span><span class="nl">"state"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="nl">"time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-01-05"</span><span class="p">},</span><span class="w"> </span><span class="nl">"1"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"</span><span class="se">\u</span><span class="s2">89c2</span><span class="se">\u</span><span class="s2">6469</span><span class="se">\u</span><span class="s2">5361</span><span class="se">\u</span><span class="s2">6362</span><span class="se">\u</span><span class="s2">9009</span><span class="se">\u</span><span class="s2">7968"</span><span class="p">,</span><span class="w"> </span><span class="nl">"details"</span><span class="p">:</span><span class="w"> </span><span class="s2">"</span><span class="se">\u</span><span class="s2">897f</span><span class="se">\u</span><span class="s2">697c</span><span class="se">\u</span><span class="s2">5927</span><span class="se">\u</span><span class="s2">5385</span><span class="se">\u</span><span class="s2">6559</span><span class="se">\u</span><span class="s2">5bfc</span><span class="se">\u</span><span class="s2">5904"</span><span class="p">,</span><span class="w"> </span><span class="nl">"ddl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-01-06"</span><span class="p">,</span><span class="w"> </span><span class="nl">"state"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="nl">"time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-01-06"</span><span class="p">},</span><span class="w"> </span><span class="nl">"2"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"</span><span class="se">\u</span><span class="s2">6570</span><span class="se">\u</span><span class="s2">5b66</span><span class="se">\u</span><span class="s2">5c0f</span><span class="se">\u</span><span class="s2">7ec4</span><span class="se">\u</span><span class="s2">4efb</span><span class="se">\u</span><span class="s2">52a1"</span><span class="p">,</span><span class="w"> </span><span class="nl">"details"</span><span class="p">:</span><span class="w"> </span><span class="s2">"</span><span class="se">\u</span><span class="s2">7ed8</span><span class="se">\u</span><span class="s2">5236</span><span class="se">\u</span><span class="s2">5317</span><span class="se">\u</span><span class="s2">4eac</span><span class="se">\u</span><span class="s2">5e02</span><span class="se">\u</span><span class="s2">5546</span><span class="se">\u</span><span class="s2">573a</span><span class="se">\u</span><span class="s2">56fe</span><span class="se">\u</span><span class="s2">5c42"</span><span class="p">,</span><span class="w"> </span><span class="nl">"ddl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-01-31"</span><span class="p">,</span><span class="w"> </span><span class="nl">"state"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="nl">"time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-01-06"</span><span class="p">}}</span><span class="w">
</span></code></pre></div></div>

<p>è¿™æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œæ¯ä¸€ä¸ªå…³é”®å­—éƒ½å¯¹åº”ä¸€ä¸ªå€¼ï¼Œç®€ç§°ä¸ºé”®å€¼å¯¹ã€‚è™½ç„¶æ ¼å¼<strong>æ¯”è¾ƒç®€å•</strong>ï¼Œä½†æ‰€éœ€åŠŸèƒ½éƒ½å¾ˆå®Œæ•´ã€‚</p>

<ol>
  <li>æ•°æ®ä¸­â€œ0â€ï¼Œâ€œ1â€ï¼Œâ€œ2â€å…³é”®å­—å°±æ˜¯å”¯ä¸€ç¡®å®šçš„ç¼–å·ã€‚æˆ‘ä¹ æƒ¯ä»0å¼€å§‹è¿›è¡Œç¼–å·ï¼Œä½†è¡¨æ ¼æ˜¯æ˜¾ç¤ºç»™å¤§å¤šæ•°äººçš„ï¼Œ<strong>æ­£å¸¸</strong>äººéƒ½ä¹ æƒ¯ä»1å¼€å§‹ç¼–å·ã€‚æ‰€ä»¥åœ¨æ˜¾ç¤ºç¼–å·æ—¶ä¼šç»™ä»–ä»¬åŠ 1ã€‚</li>
  <li>æ•°æ®ä¸­çš„â€œnameâ€å…³é”®å­—å°±æ˜¯å¾…åŠåç§°ï¼Œå¯ä»¥è¯´æ˜¯æ—¥ç¨‹æ¦‚è¦ã€‚å¯ä»¥å‘ç°ï¼Œâ€œnameâ€çš„å€¼ä¸æ˜¯ä¸­æ–‡è€Œæ˜¯ä¸ªå«uçš„å­—ç¬¦ä¸²ï¼Œè¿™æ˜¯unicodeç¼–ç ï¼ŒæŠŠä¸­æ–‡å­—ç¬¦è½¬åŒ–ä¸ºè®¡ç®—æœºé€šç”¨çš„å­—ç¬¦ã€‚</li>
  <li>æ•°æ®ä¸­â€œdetailsâ€å…³é”®å­—å°±æ˜¯æ—¥ç¨‹ç»†èŠ‚ã€‚</li>
  <li>â€œddlâ€å°±æ˜¯<del>ç»å¸¸ä¼šå’•çš„ä¸œè¥¿</del>æˆªæ­¢æ—¥æœŸã€‚</li>
  <li>â€œstateâ€å…³é”®å­—æ˜¯æ§åˆ¶æ˜¯å¦æ˜¾ç¤ºåœ¨è¡¨æ ¼ä¸­çš„ã€‚è¿™ä¸ªä¸åˆ é™¤åŠŸèƒ½ç›¸è”ç³»ï¼Œåæ–‡è¿˜ä¼šå†è®²ã€‚</li>
  <li>â€œtimeâ€å…³é”®å­—æ˜¯æ’å…¥æ—¶é—´ï¼Œè¿™ä¸ªæ˜¯ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„ï¼Œä¸ºäº†æ–¹é¢æ—¥åçš„ç»Ÿè®¡å·¥ä½œã€‚</li>
</ol>

<h3 id="5æ•°æ®çš„å­˜å‚¨å’Œè¯»å–">5.æ•°æ®çš„å­˜å‚¨å’Œè¯»å–</h3>

<p>ç”±äºæˆ‘ä½¿ç”¨çš„æ˜¯jsonæ ¼å¼ï¼Œjsonæ˜¯ä¸€ä¸ªpythonçš„åº“ï¼Œéœ€è¦åœ¨æœ€å¼€å§‹çš„åœ°æ–¹å¼•å…¥è¿›æ¥</p>

<p>åŒæ—¶åœ¨å­˜å‚¨æ•°æ®æ—¶éœ€è¦ç³»ç»Ÿè‡ªåŠ¨å­˜å…¥æ’å…¥æ—¶é—´ï¼Œæ‰€ä»¥éœ€è¦å¯¼å…¥timeåº“</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#æ–°å¢å†…å®¹
</span><span class="kn">import</span> <span class="nn">json</span> <span class="c1">#å¯¼å…¥jsonåº“
</span><span class="kn">import</span> <span class="nn">time</span>

<span class="o">---</span>
<span class="c1">#åŸæœ‰å†…å®¹
</span><span class="n">tab2</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">nb</span><span class="p">)</span>
<span class="n">nb</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">tab2</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s">"ç®¡ç†å¾…åŠ"</span><span class="p">)</span>

<span class="o">---</span>
<span class="c1">#æ–°å¢å†…å®¹
</span>
<span class="c1">#è½½å…¥jsonæ•°æ®
</span><span class="k">def</span> <span class="nf">read_data</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">data</span> <span class="c1">#å£°æ˜å…¨å±€å˜é‡
</span>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"data.json"</span><span class="p">,</span><span class="s">"r"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> <span class="c1">#æ‰“å¼€æœ¬åœ°æ–‡ä»¶
</span>        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">read_data</span><span class="p">()</span>

<span class="o">---</span>
<span class="c1">#åŸæœ‰å†…å®¹
</span><span class="n">e3</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">tab2</span><span class="p">)</span>
<span class="n">e3</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="o">---</span>
<span class="c1">#æ–°å¢å†…å®¹
</span>
<span class="c1">#å­˜å‚¨æ•°æ®
</span><span class="k">def</span> <span class="nf">get_data</span><span class="p">():</span>
    <span class="n">datas</span> <span class="o">=</span><span class="p">{}</span>
    <span class="n">datas</span><span class="p">[</span><span class="s">"name"</span><span class="p">]</span> <span class="o">=</span> <span class="n">e1</span><span class="p">.</span><span class="n">get</span><span class="p">()</span>
    <span class="n">datas</span><span class="p">[</span><span class="s">"details"</span><span class="p">]</span> <span class="o">=</span> <span class="n">e2</span><span class="p">.</span><span class="n">get</span><span class="p">()</span>
    <span class="n">datas</span><span class="p">[</span><span class="s">"ddl"</span><span class="p">]</span> <span class="o">=</span> <span class="n">date</span><span class="p">.</span><span class="n">get</span><span class="p">()</span>
    <span class="n">datas</span><span class="p">[</span><span class="s">"state"</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">datas</span><span class="p">[</span><span class="s">"time"</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">"%Y-%m-%d"</span><span class="p">,</span><span class="n">time</span><span class="p">.</span><span class="n">gmtime</span><span class="p">())</span>

    <span class="n">i</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    

    
    <span class="n">data</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">datas</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"data.json"</span><span class="p">,</span><span class="s">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> <span class="c1">#æ‰“å¼€æœ¬åœ°æ–‡ä»¶
</span>        <span class="n">json</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">f</span><span class="p">)</span>
<span class="o">---</span>
<span class="c1">#æ›´æ”¹å†…å®¹
#æŠŠget_dataåŠŸèƒ½ç»‘å®šåˆ°b1æŒ‰é’®ä¸Š
</span><span class="n">b1</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Button</span><span class="p">(</span><span class="n">tab2</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">"æ·»åŠ å¾…åŠ"</span><span class="p">,</span><span class="n">command</span><span class="o">=</span><span class="n">get_data</span><span class="p">)</span> <span class="c1">#æ–°å¢äº†commandå±æ€§
</span><span class="n">b1</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">columnspan</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>


</code></pre></div></div>

<p>è¿™æ®µå†…å®¹éƒ¨åˆ†æ¶‰åŠäº†jsonçš„å­˜å–ï¼Œä½ å¯ä»¥é€šè¿‡è®¿é—®<a href="https://www.jb51.net/article/158301.htm">è¿™ä¸ªç½‘ç«™</a>æ¥äº†è§£å¦‚ä½•å­˜å–jsonã€‚</p>

<p>åœ¨å†…å®¹ä¸­ä¸€å¤„ä½¿ç”¨äº†globalå…³é”®å­—ï¼Œè¿™æ˜¯å£°æ˜ä¸€ä¸ªå˜é‡çš„å…¨å±€æ€§ã€‚å˜é‡çš„ä½œç”¨èŒƒå›´æ˜¯æœ‰åŒºåˆ«çš„ï¼Œåˆ†ä¸ºå…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡ã€‚å…¨å±€å˜é‡å¯ä»¥åœ¨ç¨‹åºçš„ä»»ä½•ä½ç½®è®¿é—®ï¼Œè€Œå±€éƒ¨å˜é‡åªèƒ½åœ¨ä¸€å®šçš„èŒƒå›´å†…ä½¿ç”¨ã€‚</p>

<p>buttonç»„ä»¶å¯ä»¥ç»‘å®šåŠŸèƒ½ï¼Œå°±æ˜¯å®ä¾‹ä¸­çš„commandå±æ€§ã€‚ä½†è¿™ç§æ–¹æ³•åªèƒ½å®ç°<strong>ä¸éœ€è¦å®å‚</strong>çš„å‡½æ•°çš„è°ƒç”¨ã€‚è‹¥éœ€è¦ä¼ å…¥å‚æ•°çš„è¯éœ€è¦ä½¿ç”¨lambdaè¯­æ³•ã€‚</p>

<p><strong>è¿è¡Œæ•ˆæœï¼š</strong></p>

<p>å¦‚æœæ•°æ®æ­£å¸¸çš„è¯ä¸ä¼šå’Œä¸Šä¸€èŠ‚çš„è¿è¡Œç»“æœæœ‰ä»»ä½•åŒºåˆ«ï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¸æ”¾å›¾äº†ã€‚å¦‚æœä½ ä¸æ”¾å¿ƒæ˜¯å¦ä¸€åˆ‡æ­£å¸¸çš„è¯å¯ä»¥åœ¨window.mainloop()å‰åŠ ä¸Š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#æ–°å¢å†…å®¹
</span><span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="o">---</span>
<span class="c1">#åŸæœ‰å†…å®¹
</span><span class="n">window</span><span class="p">.</span><span class="n">mainloop</span><span class="p">()</span>
</code></pre></div></div>

<p>å¦‚æœä½ è¾“å‡ºçš„ç»“æœæ˜¯</p>

<pre><code class="language-txt">{'0': {'name': 'è¯­æ–‡', 'details': 'çŸ­è¯„', 'ddl': '2021-01-05', 'state': True, 'time': '2021-01-05'}, '1': {'name': 'è§‚æ‘©å¡æ¢é€‰ç¥¨', 'details': 'è¥¿æ¥¼å¤§å…æ•™å¯¼å¤„', 'ddl': '2021-01-06', 'state': True, 'time': '2021-01-06'}, '2': {'name': 'æ•°å­¦å°ç»„ä»»åŠ¡', 'details': 'ç»˜åˆ¶åŒ—äº¬å¸‚å•†åœºå›¾å±‚', 'ddl': '2021-01-31', 'state': True, 'time': '2021-01-06'}, '3': {'name': '', 'details': '', 'ddl': '', 'state': True, 'time': '2021-01-06'}, '4': {'name': '', 'details': '', 'ddl': '', 'state': True, 'time': '2021-01-06'}, '5': {'name': '', 'details': '', 'ddl': '', 'state': True, 'time': '2021-01-06'}, '6': {'name': '', 'details': '', 'ddl': '', 'state': True, 'time': '2021-01-06'}, '7': {'name': '', 'details': '', 'ddl': '', 'state': True, 'time': '2021-01-06'}, '8': {'name': '', 'details': '', 'ddl': '', 'state': True, 'time': '2021-01-06'}, '9': {'name': '', 'details': '', 'ddl': '', 'state': True, 'time': '2021-01-06'}, '10': {'name': '', 'details': '', 'ddl': '', 'state': True, 'time': '2021-01-06'}, '11': {'name': '', 'details': '', 'ddl': '', 'state': True, 'time': '2021-01-06'}, '12': {'name': '', 'details': '', 'ddl': '', 'state': True, 'time': '2021-01-06'}, '13': {'name': 'æ•°å­¦ä½œä¸š', 'details': 'zjqé’“é±¼', 'ddl': '2021-01-07', 'state': True, 'time': '2021-01-06'}} 
</code></pre>

<p>çš„è¯ï¼Œè¯´æ˜ä¸€åˆ‡æ­£å¸¸ã€‚</p>

<p>æµ‹è¯•å®Œåä¸€å®šè®°å¾—åˆ é™¤è¿™å¥è¯ï¼ˆæŒ‡printï¼‰ï¼</p>

<h3 id="6æ•°æ®æ˜¾ç¤ºtreeviewè¡¨æ ¼çš„æ’å…¥">6.æ•°æ®æ˜¾ç¤ºâ€”â€”treeviewè¡¨æ ¼çš„æ’å…¥</h3>

<p>è¿™ä¸€éƒ¨åˆ†è™½ç„¶çœ‹èµ·æ¥æ¯”è¾ƒå¤æ‚ï¼Œä½†éƒ½æ˜¯ç”±åŸºæœ¬çš„è¯­æ³•æ„æˆçš„ï¼Œä½ å¯ä»¥æŸ¥çœ‹<a href="https://blog.csdn.net/sinat_27382047/article/details/80161637">è¿™ç¯‡åšå®¢</a>ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">---</span>
<span class="c1">#åŸæœ‰å†…å®¹
</span><span class="k">def</span> <span class="nf">read_data</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">data</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"data.json"</span><span class="p">,</span><span class="s">"r"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">read_data</span><span class="p">()</span>
<span class="o">---</span>
<span class="c1">#æ–°å¢å†…å®¹
</span>
<span class="n">scrollBar</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Scrollbar</span><span class="p">(</span><span class="n">tab1</span><span class="p">)</span> <span class="c1">#åˆå§‹åŒ–ä¸€ä¸ªæ»šåŠ¨æ¡
</span>
<span class="c1">#åˆå§‹åŒ–ä¸€ä¸ªtreeviewè¡¨æ ¼
</span><span class="n">columns</span> <span class="o">=</span> <span class="p">(</span><span class="s">"row"</span><span class="p">,</span> <span class="s">"data"</span><span class="p">,</span> <span class="s">"ddl"</span><span class="p">,</span><span class="s">"time"</span><span class="p">)</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">ttk</span><span class="p">.</span><span class="n">Treeview</span><span class="p">(</span><span class="n">tab1</span><span class="p">,</span> <span class="n">show</span> <span class="o">=</span> <span class="s">"headings"</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span><span class="p">,</span> <span class="n">yscrollcommand</span><span class="o">=</span><span class="n">scrollBar</span><span class="p">.</span><span class="nb">set</span><span class="p">)</span>
<span class="n">tree</span><span class="p">.</span><span class="n">column</span><span class="p">(</span><span class="s">"row"</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s">"center"</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">tree</span><span class="p">.</span><span class="n">column</span><span class="p">(</span><span class="s">"data"</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s">"center"</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="mi">150</span><span class="p">)</span>
<span class="n">tree</span><span class="p">.</span><span class="n">column</span><span class="p">(</span><span class="s">"ddl"</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s">"center"</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="mi">80</span><span class="p">)</span>
<span class="n">tree</span><span class="p">.</span><span class="n">column</span><span class="p">(</span><span class="s">"time"</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s">"center"</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="mi">80</span><span class="p">)</span>
<span class="n">tree</span><span class="p">.</span><span class="n">heading</span><span class="p">(</span><span class="s">"row"</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s">"ç¼–å·"</span><span class="p">)</span>
<span class="n">tree</span><span class="p">.</span><span class="n">heading</span><span class="p">(</span><span class="s">"data"</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s">"å¾…åŠäº‹é¡¹"</span><span class="p">)</span>
<span class="n">tree</span><span class="p">.</span><span class="n">heading</span><span class="p">(</span><span class="s">"ddl"</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s">"ddl"</span><span class="p">)</span>
<span class="n">tree</span><span class="p">.</span><span class="n">heading</span><span class="p">(</span><span class="s">"time"</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s">"æ’å…¥æ—¶é—´"</span><span class="p">)</span>


<span class="n">scrollBar</span><span class="p">.</span><span class="n">config</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="n">tree</span><span class="p">.</span><span class="n">yview</span><span class="p">)</span> <span class="c1">#æŠŠæ»šåŠ¨æ¡ç»‘å®šåˆ°è¡¨æ ¼
</span><span class="n">scrollBar</span><span class="p">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="p">.</span><span class="n">RIGHT</span><span class="p">,</span><span class="n">fill</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Y</span><span class="p">)</span> <span class="c1">#æŠŠæ»šåŠ¨æ¡æ˜¾ç¤ºåˆ°çª—å£ä¸­
</span>    
<span class="c1">#ç»™treeviewè¡¨æ ¼æ·»åŠ æ•°æ®
</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">data1</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span> <span class="c1">#è¿™æ˜¯ä¸€ä¸ªéå†
</span>    <span class="c1">#ä»dataè¿™ä¸ªæ•°æ®å­—å…¸ä¸­å–æ•°æ®
</span>    <span class="n">name1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data1</span><span class="p">][</span><span class="s">"name"</span><span class="p">]</span>
    <span class="n">ddl1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data1</span><span class="p">][</span><span class="s">"ddl"</span><span class="p">]</span>
    <span class="n">state1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data1</span><span class="p">][</span><span class="s">"state"</span><span class="p">]</span> <span class="c1">#æˆ–è®¸è¯¥æ•°æ®çš„çŠ¶æ€ï¼Œæ˜¯å¦æ˜¾ç¤ºåœ¨è¡¨æ ¼ä¸­ï¼Œåˆ é™¤æ•°æ®æ—¶çš„åŠŸèƒ½
</span>    <span class="n">time1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data1</span><span class="p">][</span><span class="s">"time"</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">state1</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="c1">#åˆ¤æ–­æ˜¯å¦åº”è¯¥æ˜¾ç¤ºåœ¨è¡¨æ ¼ä¸­ï¼Œæ˜¯åˆ é™¤æ•°æ®æ—¶çš„åŠŸèƒ½ï¼Œå…ˆæ”¾åœ¨è¿™é‡Œ
</span>        <span class="n">tree</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="s">""</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">values</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">name1</span><span class="p">,</span><span class="n">ddl1</span><span class="p">,</span><span class="n">time1</span><span class="p">))</span>
    <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
<span class="n">tree</span><span class="p">.</span><span class="n">pack</span><span class="p">()</span>
<span class="o">---</span>
<span class="c1">#åŸæœ‰å†…å®¹
#å¾…åŠç®¡ç†é¡µ
</span><span class="n">l1</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Label</span><span class="p">(</span><span class="n">tab2</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">"å¾…åŠåç§°ï¼š"</span><span class="p">)</span>
<span class="n">l1</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

</code></pre></div></div>

<p>ä¸ºäº†æŠŠå­˜å…¥æ•°æ®çš„å¾…åŠæ˜¾ç¤ºå‡ºæ¥ï¼Œæˆ‘é€‰æ‹©äº†ä½¿ç”¨ttkçš„treeviewè¡¨æ ¼æ¥å®ç°ï¼Œè¿™ä¸ªè¡¨æ ¼å¯ä»¥æ¸…æ™°åœ°å±•ç¤ºä¸€ä¸ªå¾…åŠçš„å„ç§ä¿¡æ¯ã€‚</p>

<p>ä¸è¿‡å› ä¸ºè®¾è®¡åŸå› ï¼Œtreeviewåªèƒ½åœ¨ä¸€é¡µå†…æ˜¾ç¤ºåæ¡æ•°æ®ï¼Œå¦‚æœå¤šäºåæ¡çš„è¯å°±æ— æ³•æ˜¾ç¤ºã€‚æ‰€ä»¥è¿™é‡ŒåŠ å…¥äº†ä¸€ä¸ªæ»šåŠ¨æ¡æ¥æ»šåŠ¨æ•°æ®ï¼Œè¿™æ ·å°±èƒ½æ˜¾ç¤ºæ›´å¤šæ•°æ®äº†ã€‚</p>

<p>å¯¹äºç¨‹åºçš„è¯´æ˜å·²ç»éå¸¸ç»†è‡´åœ°å†™åœ¨äº†æ³¨é‡Šé‡Œï¼Œè¯·ä»”ç»†æŸ¥çœ‹ï¼Œæˆ–è®¸å¯ä»¥å¸®åŠ©ç†è§£ã€‚</p>

<p><strong>è¿è¡Œæ•ˆæœï¼š</strong></p>

<p><img src="..\images\2021-01-05-event-management\3-6.png" alt="img" /></p>

<h3 id="7treeviewè¡¨æ ¼çš„å®Œå–„æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯">7.treeviewè¡¨æ ¼çš„å®Œå–„ï¼Œæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">---</span>
<span class="c1">#åŸæœ‰å†…å®¹
</span><span class="n">tree</span><span class="p">.</span><span class="n">pack</span><span class="p">()</span>
<span class="o">---</span>
<span class="c1">#æ–°å¢å†…å®¹
</span><span class="k">def</span> <span class="nf">treeviewClick</span><span class="p">(</span><span class="n">event</span><span class="p">):</span> <span class="c1">#å•å‡»äº‹ä»¶
</span>    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">tree</span><span class="p">.</span><span class="n">selection</span><span class="p">():</span>
        <span class="n">item_text</span> <span class="o">=</span> <span class="n">tree</span><span class="p">.</span><span class="n">item</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="s">"values"</span><span class="p">)</span>
        <span class="n">t1</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span><span class="s">'1.0'</span><span class="p">,</span> <span class="s">"end"</span><span class="p">)</span> <span class="c1">#æŠŠtextç»„ä»¶ä¸­çš„å†…å®¹å…¨éƒ¨åˆ æ‰ï¼Œå› ä¸ºt1è¿™ä¸ªç»„ä»¶åªèµ·åˆ°æ˜¾ç¤ºåŠŸèƒ½ï¼Œå¦‚æœæˆ‘æ¢äº†ä¸‹ä¸€ä¸ªå¾…åŠï¼Œåº”è¯¥åªæ˜¾ç¤ºæ–°å¾…åŠçš„è¯¦ç»†ä¿¡æ¯
</span>        <span class="k">for</span> <span class="n">data3</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">data4</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data3</span><span class="p">][</span><span class="s">"details"</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">data3</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">item_text</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">t1</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="s">"end"</span><span class="p">,</span><span class="n">data4</span><span class="p">)</span> <span class="c1">#æ’å…¥è¯¦ç»†æ•°æ®
</span>
<span class="n">tree</span><span class="p">.</span><span class="n">bind</span><span class="p">(</span><span class="s">'&lt;ButtonRelease-1&gt;'</span><span class="p">,</span> <span class="n">treeviewClick</span><span class="p">)</span> <span class="c1">#æŠŠåŠŸèƒ½ç»‘å®šç»™è¡¨æ ¼
</span>
<span class="c1">#æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ç»„ä»¶
</span><span class="n">f1</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">tab1</span><span class="p">)</span>
<span class="n">f1</span><span class="p">.</span><span class="n">pack</span><span class="p">()</span>
<span class="n">l3</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Label</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">"ç‚¹å‡»è¡¨æ ¼æŸ¥çœ‹äº‹ä»¶è¯¦æƒ…ï¼š"</span><span class="p">)</span>
<span class="n">l3</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">t1</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Text</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">t1</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="o">---</span>
<span class="c1">#åŸæœ‰å†…å®¹
#å¾…åŠç®¡ç†é¡µ
</span><span class="n">l1</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Label</span><span class="p">(</span><span class="n">tab2</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">"å¾…åŠåç§°ï¼š"</span><span class="p">)</span>
<span class="n">l1</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

</code></pre></div></div>

<p>ä½ ç°åœ¨è¿˜<strong>ä¸éœ€è¦</strong>å¯¹æ¯ä¸€è¡Œä»£ç éƒ½å®Œå…¨ç†è§£ï¼Œå› ä¸ºå¾ˆå¤šç¨‹åºé€»è¾‘è§çš„å†™çš„å¤šäº†ï¼Œè‡ªç„¶è€Œç„¶å°±èƒ½ç†è§£äº†ã€‚æ‰€ä»¥æœ‰é‡åˆ°çœ‹ä¸æ‡‚çš„å°±ç†è§£ä¸ªå¤§æ¦‚å³å¯ã€‚</p>

<p>è¿™å‡ è¡Œä»£ç æŠŠéšè—åœ¨æ•°æ®æ–‡ä»¶ä¸­æ²¡æœ‰æ˜¾ç¤ºåœ¨è¡¨æ ¼é‡Œçš„è¯¦ç»†ä¿¡æ¯æ˜¾ç¤ºå‡ºæ¥äº†ã€‚</p>

<p><strong>è¿è¡Œæ•ˆæœï¼š</strong></p>

<p><img src="..\images\2021-01-05-event-management\3-7.png" alt="img" /></p>

<h3 id="8æ·»åŠ åˆ é™¤åŠŸèƒ½">8.æ·»åŠ åˆ é™¤åŠŸèƒ½</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">---</span>
<span class="c1">#åŸæœ‰å†…å®¹
</span><span class="n">b1</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Button</span><span class="p">(</span><span class="n">tab2</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">"æ·»åŠ å¾…åŠ"</span><span class="p">,</span><span class="n">command</span><span class="o">=</span><span class="n">get_data</span><span class="p">)</span>
<span class="n">b1</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">columnspan</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>

<span class="o">---</span>
<span class="c1">#æ–°å¢å†…å®¹
</span>
<span class="c1">#æ·»åŠ æ–‡å­—æç¤ºçš„ç»„ä»¶
</span><span class="n">l5</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Label</span><span class="p">(</span><span class="n">tab2</span><span class="p">)</span>
<span class="n">l5</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">l4</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Label</span><span class="p">(</span><span class="n">tab2</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">"è¯·è¾“å…¥ç¼–å·ï¼ˆè¡¨æ ¼ç¬¬ä¸€åˆ—ï¼‰:"</span><span class="p">)</span>
<span class="n">l4</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">column</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">e4</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">tab2</span><span class="p">)</span>
<span class="n">e4</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">#ä¿®æ”¹æ•°æ®æ–‡ä»¶
</span><span class="k">def</span> <span class="nf">delete_data</span><span class="p">():</span>
    <span class="n">order</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">e4</span><span class="p">.</span><span class="n">get</span><span class="p">())</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#ç”¨æˆ·è¾“å…¥çš„æ•°æ®ç´¢å¼•ï¼Œä¹Ÿå°±æ˜¯å¾…åŠçš„å”¯ä¸€ç¼–å·
</span>    <span class="n">state3</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">order</span><span class="p">][</span><span class="s">"state"</span><span class="p">]</span> 
    <span class="k">if</span> <span class="n">state3</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="c1">#å¦‚æœåŸæ•°æ®çš„çŠ¶æ€æ˜¯trueä¹Ÿå°±æ˜¯åœ¨è¡¨æ ¼ä¸­æ˜¾ç¤ºçš„è¯
</span>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"data.json"</span><span class="p">,</span><span class="s">"r"</span><span class="p">)</span> <span class="k">as</span> <span class="n">load_f</span><span class="p">:</span>
            <span class="n">load_dict</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="n">load_f</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">load_dict</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">order</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="n">load_dict</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">"state"</span><span class="p">])</span>
                    <span class="n">load_dict</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">"state"</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span> <span class="c1">#æŠŠè¿™ä¸ªæ§åˆ¶æ˜¯å¦æ˜¾ç¤ºçš„å€¼æ”¹ä¸ºfalseï¼Œä½¿å…¶åœ¨è¡¨æ ¼ä¸­æ¶ˆå¤±ã€‚
</span>                    
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"data.json"</span><span class="p">,</span><span class="s">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">dump_f</span><span class="p">:</span>
            <span class="n">json</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">load_dict</span><span class="p">,</span><span class="n">dump_f</span><span class="p">)</span>

<span class="n">b2</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Button</span><span class="p">(</span><span class="n">tab2</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">"åˆ é™¤å¾…åŠ"</span><span class="p">,</span><span class="n">command</span><span class="o">=</span><span class="n">delete_data</span><span class="p">)</span>
<span class="n">b2</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="o">---</span>
<span class="c1">#åŸæœ‰å†…å®¹
#å¾…åŠç®¡ç†é¡µ
</span><span class="n">l1</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Label</span><span class="p">(</span><span class="n">tab2</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">"å¾…åŠåç§°ï¼š"</span><span class="p">)</span>
<span class="n">l1</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

</code></pre></div></div>

<p>ç»ˆäºåˆ°äº†åˆ é™¤åŠŸèƒ½ï¼Œè¿™ä¸ªä¸å‰é¢æ•°æ®è¡¨çš„è®¾è®¡æœ‰å¾ˆå¤§çš„å…³ç³»ã€‚æˆ‘æ˜¯é€šè¿‡ç»™æ¯ä¸ªå¾…åŠæ·»åŠ ä¸€ä¸ªæ˜¯å¦æ˜¾ç¤ºçš„å±æ€§ï¼Œæ¥å®ç°åˆ é™¤æ•ˆæœçš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸€æ¡å¾…åŠå³ä½¿ä½ ç‚¹å‡»åˆ é™¤åä¹Ÿä¸ä¼šçœŸæ­£åˆ é™¤ï¼Œè€Œåªæ˜¯éšè—ã€‚</p>

<p>è¿™ä¹ˆåšæœ‰å‡ ä¸ªè€ƒè™‘ï¼Œä¸€æ˜¯å¦‚æœä¸€ä¸å°å¿ƒæ‰‹æŠ–åˆ æ‰äº†ä¸€ä¸ªä¸è¯¥åˆ çš„æ•°æ®ï¼Œè¿˜å¯ä»¥å¾ˆè½»æ¾çš„æ‰¾å›ï¼Œåªè¦å»æ•°æ®æ–‡ä»¶é‡ŒæŠŠæ˜¯å¦æ˜¾ç¤ºçš„å±æ€§æ›´æ”¹ä¸€ä¸‹å³å¯ã€‚äºŒæ˜¯åœ¨å¹´ç»ˆå¦‚æœæƒ³è¦ç»Ÿè®¡è‡ªå·±è¿™ä¸€å¹´åšäº†ä»€ä¹ˆäº‹æƒ…çš„è¯ï¼Œå¯ä»¥å¾ˆè½»æ¾çš„æŸ¥çœ‹ï¼Œè€Œä¸æ˜¯å®Œæˆä¸€æ¡åˆ ä¸€æ¡ï¼Œåˆ°å¹´ç»ˆä¸€æ¡ä¹Ÿä¸å‰©äº†<del>å‰©ä¸‹çš„éƒ½æ˜¯å’•å’•å’•çš„ddl</del>ã€‚</p>

<p><br /></p>

<p>é‚£ä¹ˆåœ¨å®ç°çš„æ—¶å€™ï¼Œé¦–å…ˆè¦ä¿®æ”¹æ•°æ®æ–‡ä»¶ï¼Œç„¶åå†å»åœ¨æ’å…¥è¡¨æ ¼å‰åˆ¤æ–­ä¸€ä¸‹è¿™ä¸ªæ•°æ®æ˜¯å·²ç»è¢«â€œåˆ é™¤â€æ‰äº†è¿˜æ˜¯å¯ä»¥æ­£å¸¸æ˜¾ç¤ºã€‚è¿™ä¸ªåŠŸèƒ½å°±å®Œæˆäº†ã€‚</p>

<p>åˆ¤æ–­åŠŸèƒ½åœ¨ä¹‹å‰æ’å…¥è¡¨æ ¼æ—¶å°±å·²ç»å†™ä¸Šäº†ï¼Œå¯ä»¥å›åˆ°ç¬¬å…­èŠ‚æŸ¥çœ‹ã€‚</p>

<p><strong>è¿è¡Œæ•ˆæœï¼š</strong></p>

<p><img src="..\images\2021-01-05-event-management\3-8.png" alt="img" /></p>

<p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œæ ‡å·ä¸º4çš„å¾…åŠè¢«åˆ é™¤æ‰äº†ã€‚ä½ ä¹Ÿå¯ä»¥è¯•ä¸€è¯•åˆ é™¤å…¶ä»–ç¼–å·çš„æ•°æ®ã€‚</p>

<h3 id="9å®Œå–„æ’å…¥ddlåŠŸèƒ½1">9.å®Œå–„æ’å…¥ddlåŠŸèƒ½1</h3>

<p><strong>ä½ å°†çœ‹åˆ°ä¸€æ®µå·¨é•¿æ— æ¯”çš„ä»£ç ï¼Œä»datetime = calendar.datetime.datetimeå¼€å§‹ä½ å®Œå…¨ä¸éœ€è¦çœ‹æ‡‚ï¼Œç›´æ¥å¤åˆ¶å³å¯</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#åŸæœ‰å†…å®¹
#å¯¼å…¥åº“
</span><span class="kn">import</span> <span class="nn">tkinter</span> <span class="k">as</span> <span class="n">tk</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">ttk</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="o">---</span>
<span class="c1">#æ–°å¢å†…å®¹
</span><span class="kn">import</span> <span class="nn">calendar</span> <span class="c1">#æ–°å¢æ—¥å†åº“
</span><span class="kn">import</span> <span class="nn">tkinter.font</span> <span class="k">as</span> <span class="n">tkFont</span> <span class="c1">#æ–°å¢å­—ä½“åº“
</span>
<span class="n">datetime</span> <span class="o">=</span> <span class="n">calendar</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span>
<span class="n">timedelta</span> <span class="o">=</span> <span class="n">calendar</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="n">timedelta</span>

<span class="k">class</span> <span class="nc">Calendar</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">point</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        
        <span class="n">s</span><span class="p">.</span><span class="n">master</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Toplevel</span><span class="p">()</span>
        <span class="n">s</span><span class="p">.</span><span class="n">master</span><span class="p">.</span><span class="n">withdraw</span><span class="p">()</span>
        <span class="n">fwday</span> <span class="o">=</span> <span class="n">calendar</span><span class="p">.</span><span class="n">SUNDAY</span>

        <span class="n">year</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">year</span>
        <span class="n">month</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">month</span>
        <span class="n">locale</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">sel_bg</span> <span class="o">=</span> <span class="s">'#ecffc4'</span>
        <span class="n">sel_fg</span> <span class="o">=</span> <span class="s">'#05640e'</span>

        <span class="n">s</span><span class="p">.</span><span class="n">_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="n">_selection</span> <span class="o">=</span> <span class="bp">None</span> <span class="c1"># è®¾ç½®ä¸ºæœªé€‰ä¸­æ—¥æœŸ
</span>
        <span class="n">s</span><span class="p">.</span><span class="n">G_Frame</span> <span class="o">=</span> <span class="n">ttk</span><span class="p">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">master</span><span class="p">)</span>

        <span class="n">s</span><span class="p">.</span><span class="n">_cal</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">__get_calendar</span><span class="p">(</span><span class="n">locale</span><span class="p">,</span> <span class="n">fwday</span><span class="p">)</span>

        <span class="n">s</span><span class="p">.</span><span class="n">__setup_styles</span><span class="p">()</span>       <span class="c1"># åˆ›å»ºè‡ªå®šä¹‰æ ·å¼
</span>        <span class="n">s</span><span class="p">.</span><span class="n">__place_widgets</span><span class="p">()</span>      <span class="c1"># pack/grid å°éƒ¨ä»¶
</span>        <span class="n">s</span><span class="p">.</span><span class="n">__config_calendar</span><span class="p">()</span>    <span class="c1"># è°ƒæ•´æ—¥å†åˆ—å’Œå®‰è£…æ ‡è®°
</span>        <span class="c1"># é…ç½®ç”»å¸ƒå’Œæ­£ç¡®çš„ç»‘å®šï¼Œä»¥é€‰æ‹©æ—¥æœŸã€‚
</span>        <span class="n">s</span><span class="p">.</span><span class="n">__setup_selection</span><span class="p">(</span><span class="n">sel_bg</span><span class="p">,</span> <span class="n">sel_fg</span><span class="p">)</span>

        <span class="c1"># å­˜å‚¨é¡¹IDï¼Œç”¨äºç¨åæ’å…¥ã€‚
</span>        <span class="n">s</span><span class="p">.</span><span class="n">_items</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="p">.</span><span class="n">_calendar</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="s">''</span><span class="p">,</span> <span class="s">'end'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">''</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>

        <span class="c1"># åœ¨å½“å‰ç©ºæ—¥å†ä¸­æ’å…¥æ—¥æœŸ
</span>        <span class="n">s</span><span class="p">.</span><span class="n">_update</span><span class="p">()</span>

        <span class="n">s</span><span class="p">.</span><span class="n">G_Frame</span><span class="p">.</span><span class="n">pack</span><span class="p">(</span><span class="n">expand</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s">'both'</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="n">master</span><span class="p">.</span><span class="n">overrideredirect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="n">master</span><span class="p">.</span><span class="n">update_idletasks</span><span class="p">()</span>
        <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">master</span><span class="p">.</span><span class="n">winfo_reqwidth</span><span class="p">(),</span> <span class="n">s</span><span class="p">.</span><span class="n">master</span><span class="p">.</span><span class="n">winfo_reqheight</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">point</span> <span class="ow">and</span> <span class="n">position</span><span class="p">:</span>
            <span class="k">if</span>   <span class="n">position</span> <span class="o">==</span> <span class="s">'ur'</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">height</span>
            <span class="k">elif</span> <span class="n">position</span> <span class="o">==</span> <span class="s">'lr'</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">position</span> <span class="o">==</span> <span class="s">'ul'</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">width</span><span class="p">,</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">height</span>
            <span class="k">elif</span> <span class="n">position</span> <span class="o">==</span> <span class="s">'ll'</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">width</span><span class="p">,</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">master</span><span class="p">.</span><span class="n">winfo_screenwidth</span><span class="p">()</span> <span class="o">-</span> <span class="n">width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">master</span><span class="p">.</span><span class="n">winfo_screenheight</span><span class="p">()</span> <span class="o">-</span> <span class="n">height</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">s</span><span class="p">.</span><span class="n">master</span><span class="p">.</span><span class="n">geometry</span><span class="p">(</span><span class="s">'%dx%d+%d+%d'</span> <span class="o">%</span> <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span> <span class="c1">#çª—å£ä½ç½®å±…ä¸­
</span>        <span class="n">s</span><span class="p">.</span><span class="n">master</span><span class="p">.</span><span class="n">after</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">_main_judge</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="n">master</span><span class="p">.</span><span class="n">deiconify</span><span class="p">()</span>
        <span class="n">s</span><span class="p">.</span><span class="n">master</span><span class="p">.</span><span class="n">focus_set</span><span class="p">()</span>
        <span class="n">s</span><span class="p">.</span><span class="n">master</span><span class="p">.</span><span class="n">wait_window</span><span class="p">()</span> <span class="c1">#è¿™é‡Œåº”è¯¥ä½¿ç”¨wait_windowæŒ‚èµ·çª—å£ï¼Œå¦‚æœä½¿ç”¨mainloop,å¯èƒ½ä¼šå¯¼è‡´ä¸»ç¨‹åºå¾ˆå¤šé”™è¯¯
</span>
    <span class="k">def</span> <span class="nf">__get_calendar</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">locale</span><span class="p">,</span> <span class="n">fwday</span><span class="p">):</span>
        <span class="c1"># å®ä¾‹åŒ–é€‚å½“çš„æ—¥å†ç±»
</span>        <span class="k">if</span> <span class="n">locale</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">calendar</span><span class="p">.</span><span class="n">TextCalendar</span><span class="p">(</span><span class="n">fwday</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">calendar</span><span class="p">.</span><span class="n">LocaleTextCalendar</span><span class="p">(</span><span class="n">fwday</span><span class="p">,</span> <span class="n">locale</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">(</span><span class="s">'year'</span><span class="p">,</span> <span class="s">'month'</span><span class="p">):</span>
            <span class="k">raise</span> <span class="nb">AttributeError</span><span class="p">(</span><span class="s">"attribute '%s' is not writeable"</span> <span class="o">%</span> <span class="n">item</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">item</span> <span class="o">==</span> <span class="s">'selectbackground'</span><span class="p">:</span>
            <span class="n">s</span><span class="p">.</span><span class="n">_canvas</span><span class="p">[</span><span class="s">'background'</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="n">item</span> <span class="o">==</span> <span class="s">'selectforeground'</span><span class="p">:</span>
            <span class="n">s</span><span class="p">.</span><span class="n">_canvas</span><span class="p">.</span><span class="n">itemconfigure</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">_canvas</span><span class="p">.</span><span class="n">text</span><span class="p">,</span> <span class="n">item</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span><span class="p">.</span><span class="n">G_Frame</span><span class="p">.</span><span class="n">__setitem__</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">(</span><span class="s">'year'</span><span class="p">,</span> <span class="s">'month'</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">_date</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">item</span> <span class="o">==</span> <span class="s">'selectbackground'</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">s</span><span class="p">.</span><span class="n">_canvas</span><span class="p">[</span><span class="s">'background'</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">item</span> <span class="o">==</span> <span class="s">'selectforeground'</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">s</span><span class="p">.</span><span class="n">_canvas</span><span class="p">.</span><span class="n">itemcget</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">_canvas</span><span class="p">.</span><span class="n">text</span><span class="p">,</span> <span class="s">'fill'</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">ttk</span><span class="p">.</span><span class="n">tclobjs_to_py</span><span class="p">({</span><span class="n">item</span><span class="p">:</span> <span class="n">ttk</span><span class="p">.</span><span class="n">Frame</span><span class="p">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">item</span><span class="p">)})</span>
            <span class="k">return</span> <span class="n">r</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__setup_styles</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="c1"># è‡ªå®šä¹‰TTKé£æ ¼
</span>        <span class="n">style</span> <span class="o">=</span> <span class="n">ttk</span><span class="p">.</span><span class="n">Style</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">master</span><span class="p">)</span>
        <span class="n">arrow_layout</span> <span class="o">=</span> <span class="k">lambda</span> <span class="nb">dir</span><span class="p">:</span> <span class="p">(</span>
            <span class="p">[(</span><span class="s">'Button.focus'</span><span class="p">,</span> <span class="p">{</span><span class="s">'children'</span><span class="p">:</span> <span class="p">[(</span><span class="s">'Button.%sarrow'</span> <span class="o">%</span> <span class="nb">dir</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]})]</span>
        <span class="p">)</span>
        <span class="n">style</span><span class="p">.</span><span class="n">layout</span><span class="p">(</span><span class="s">'L.TButton'</span><span class="p">,</span> <span class="n">arrow_layout</span><span class="p">(</span><span class="s">'left'</span><span class="p">))</span>
        <span class="n">style</span><span class="p">.</span><span class="n">layout</span><span class="p">(</span><span class="s">'R.TButton'</span><span class="p">,</span> <span class="n">arrow_layout</span><span class="p">(</span><span class="s">'right'</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__place_widgets</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="c1"># æ ‡å¤´æ¡†æ¶åŠå…¶å°éƒ¨ä»¶
</span>        <span class="n">Input_judgment_num</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">master</span><span class="p">.</span><span class="n">register</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">Input_judgment</span><span class="p">)</span>  <span class="c1"># éœ€è¦å°†å‡½æ•°åŒ…è£…ä¸€ä¸‹ï¼Œå¿…è¦çš„
</span>        <span class="n">hframe</span> <span class="o">=</span> <span class="n">ttk</span><span class="p">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">G_Frame</span><span class="p">)</span>
        <span class="n">gframe</span> <span class="o">=</span> <span class="n">ttk</span><span class="p">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">G_Frame</span><span class="p">)</span>
        <span class="n">bframe</span> <span class="o">=</span> <span class="n">ttk</span><span class="p">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">G_Frame</span><span class="p">)</span>
        <span class="n">hframe</span><span class="p">.</span><span class="n">pack</span><span class="p">(</span><span class="n">in_</span><span class="o">=</span><span class="n">s</span><span class="p">.</span><span class="n">G_Frame</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s">'top'</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s">'center'</span><span class="p">)</span>
        <span class="n">gframe</span><span class="p">.</span><span class="n">pack</span><span class="p">(</span><span class="n">in_</span><span class="o">=</span><span class="n">s</span><span class="p">.</span><span class="n">G_Frame</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">tk</span><span class="p">.</span><span class="n">X</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">bframe</span><span class="p">.</span><span class="n">pack</span><span class="p">(</span><span class="n">in_</span><span class="o">=</span><span class="n">s</span><span class="p">.</span><span class="n">G_Frame</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s">'bottom'</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

        <span class="n">lbtn</span> <span class="o">=</span> <span class="n">ttk</span><span class="p">.</span><span class="n">Button</span><span class="p">(</span><span class="n">hframe</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">'L.TButton'</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">s</span><span class="p">.</span><span class="n">_prev_month</span><span class="p">)</span>
        <span class="n">lbtn</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">in_</span><span class="o">=</span><span class="n">hframe</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">rbtn</span> <span class="o">=</span> <span class="n">ttk</span><span class="p">.</span><span class="n">Button</span><span class="p">(</span><span class="n">hframe</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">'R.TButton'</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">s</span><span class="p">.</span><span class="n">_next_month</span><span class="p">)</span>
        <span class="n">rbtn</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">in_</span><span class="o">=</span><span class="n">hframe</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        
        <span class="n">s</span><span class="p">.</span><span class="n">CB_year</span> <span class="o">=</span> <span class="n">ttk</span><span class="p">.</span><span class="n">Combobox</span><span class="p">(</span><span class="n">hframe</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">year</span><span class="p">,</span> <span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">year</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">validate</span> <span class="o">=</span> <span class="s">'key'</span><span class="p">,</span> <span class="n">validatecommand</span> <span class="o">=</span> <span class="p">(</span><span class="n">Input_judgment_num</span><span class="p">,</span> <span class="s">'%P'</span><span class="p">))</span>
        <span class="n">s</span><span class="p">.</span><span class="n">CB_year</span><span class="p">.</span><span class="n">current</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="n">CB_year</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">in_</span><span class="o">=</span><span class="n">hframe</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="n">CB_year</span><span class="p">.</span><span class="n">bind</span><span class="p">(</span><span class="s">'&lt;KeyPress&gt;'</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">event</span><span class="p">:</span><span class="n">s</span><span class="p">.</span><span class="n">_update</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="bp">True</span><span class="p">))</span>
        <span class="n">s</span><span class="p">.</span><span class="n">CB_year</span><span class="p">.</span><span class="n">bind</span><span class="p">(</span><span class="s">"&lt;&lt;ComboboxSelected&gt;&gt;"</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">_update</span><span class="p">)</span>
        <span class="n">tk</span><span class="p">.</span><span class="n">Label</span><span class="p">(</span><span class="n">hframe</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s">'å¹´'</span><span class="p">,</span> <span class="n">justify</span> <span class="o">=</span> <span class="s">'left'</span><span class="p">).</span><span class="n">grid</span><span class="p">(</span><span class="n">in_</span><span class="o">=</span><span class="n">hframe</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

        <span class="n">s</span><span class="p">.</span><span class="n">CB_month</span> <span class="o">=</span> <span class="n">ttk</span><span class="p">.</span><span class="n">Combobox</span><span class="p">(</span><span class="n">hframe</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s">'%02d'</span> <span class="o">%</span> <span class="n">month</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">)],</span> <span class="n">state</span> <span class="o">=</span> <span class="s">'readonly'</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="n">CB_month</span><span class="p">.</span><span class="n">current</span><span class="p">(</span><span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">month</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="n">CB_month</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">in_</span><span class="o">=</span><span class="n">hframe</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="n">CB_month</span><span class="p">.</span><span class="n">bind</span><span class="p">(</span><span class="s">"&lt;&lt;ComboboxSelected&gt;&gt;"</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">_update</span><span class="p">)</span>
        <span class="n">tk</span><span class="p">.</span><span class="n">Label</span><span class="p">(</span><span class="n">hframe</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s">'æœˆ'</span><span class="p">,</span> <span class="n">justify</span> <span class="o">=</span> <span class="s">'left'</span><span class="p">).</span><span class="n">grid</span><span class="p">(</span><span class="n">in_</span><span class="o">=</span><span class="n">hframe</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># æ—¥å†éƒ¨ä»¶
</span>        <span class="n">s</span><span class="p">.</span><span class="n">_calendar</span> <span class="o">=</span> <span class="n">ttk</span><span class="p">.</span><span class="n">Treeview</span><span class="p">(</span><span class="n">gframe</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="s">''</span><span class="p">,</span> <span class="n">selectmode</span><span class="o">=</span><span class="s">'none'</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="n">_calendar</span><span class="p">.</span><span class="n">pack</span><span class="p">(</span><span class="n">expand</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s">'both'</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s">'bottom'</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

        <span class="n">ttk</span><span class="p">.</span><span class="n">Button</span><span class="p">(</span><span class="n">bframe</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s">"ç¡® å®š"</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">command</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">s</span><span class="p">.</span><span class="n">_exit</span><span class="p">(</span><span class="bp">True</span><span class="p">)).</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">column</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span> <span class="o">=</span> <span class="s">'ns'</span><span class="p">,</span> <span class="n">padx</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
        <span class="n">ttk</span><span class="p">.</span><span class="n">Button</span><span class="p">(</span><span class="n">bframe</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s">"å– æ¶ˆ"</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">command</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">_exit</span><span class="p">).</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">column</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span> <span class="o">=</span> <span class="s">'ne'</span><span class="p">,</span> <span class="n">padx</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
        
        
        <span class="n">tk</span><span class="p">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">G_Frame</span><span class="p">,</span> <span class="n">bg</span> <span class="o">=</span> <span class="s">'#565656'</span><span class="p">).</span><span class="n">place</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">relx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">rely</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">relwidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">relheigh</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">200</span><span class="p">)</span>
        <span class="n">tk</span><span class="p">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">G_Frame</span><span class="p">,</span> <span class="n">bg</span> <span class="o">=</span> <span class="s">'#565656'</span><span class="p">).</span><span class="n">place</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">relx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">rely</span> <span class="o">=</span> <span class="mi">198</span><span class="o">/</span><span class="mi">200</span><span class="p">,</span> <span class="n">relwidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">relheigh</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">200</span><span class="p">)</span>
        <span class="n">tk</span><span class="p">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">G_Frame</span><span class="p">,</span> <span class="n">bg</span> <span class="o">=</span> <span class="s">'#565656'</span><span class="p">).</span><span class="n">place</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">relx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">rely</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">relwidth</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">200</span><span class="p">,</span> <span class="n">relheigh</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">tk</span><span class="p">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">G_Frame</span><span class="p">,</span> <span class="n">bg</span> <span class="o">=</span> <span class="s">'#565656'</span><span class="p">).</span><span class="n">place</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">relx</span> <span class="o">=</span> <span class="mi">198</span><span class="o">/</span><span class="mi">200</span><span class="p">,</span> <span class="n">rely</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">relwidth</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">200</span><span class="p">,</span> <span class="n">relheigh</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__config_calendar</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="c1"># cols = s._cal.formatweekheader(3).split()
</span>        <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s">'æ—¥'</span><span class="p">,</span><span class="s">'ä¸€'</span><span class="p">,</span><span class="s">'äºŒ'</span><span class="p">,</span><span class="s">'ä¸‰'</span><span class="p">,</span><span class="s">'å››'</span><span class="p">,</span><span class="s">'äº”'</span><span class="p">,</span><span class="s">'å…­'</span><span class="p">]</span>
        <span class="n">s</span><span class="p">.</span><span class="n">_calendar</span><span class="p">[</span><span class="s">'columns'</span><span class="p">]</span> <span class="o">=</span> <span class="n">cols</span>
        <span class="n">s</span><span class="p">.</span><span class="n">_calendar</span><span class="p">.</span><span class="n">tag_configure</span><span class="p">(</span><span class="s">'header'</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s">'grey90'</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="n">_calendar</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="s">''</span><span class="p">,</span> <span class="s">'end'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s">'header'</span><span class="p">)</span>
        <span class="c1"># è°ƒæ•´å…¶åˆ—å®½
</span>        <span class="n">font</span> <span class="o">=</span> <span class="n">tkFont</span><span class="p">.</span><span class="n">Font</span><span class="p">()</span>
        <span class="n">maxwidth</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">font</span><span class="p">.</span><span class="n">measure</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
            <span class="n">s</span><span class="p">.</span><span class="n">_calendar</span><span class="p">.</span><span class="n">column</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">maxwidth</span><span class="p">,</span> <span class="n">minwidth</span><span class="o">=</span><span class="n">maxwidth</span><span class="p">,</span>
                <span class="n">anchor</span><span class="o">=</span><span class="s">'center'</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__setup_selection</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">sel_bg</span><span class="p">,</span> <span class="n">sel_fg</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">__canvas_forget</span><span class="p">(</span><span class="n">evt</span><span class="p">):</span>
            <span class="n">canvas</span><span class="p">.</span><span class="n">place_forget</span><span class="p">()</span>
            <span class="n">s</span><span class="p">.</span><span class="n">_selection</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="n">s</span><span class="p">.</span><span class="n">_font</span> <span class="o">=</span> <span class="n">tkFont</span><span class="p">.</span><span class="n">Font</span><span class="p">()</span>
        <span class="n">s</span><span class="p">.</span><span class="n">_canvas</span> <span class="o">=</span> <span class="n">canvas</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Canvas</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">_calendar</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">sel_bg</span><span class="p">,</span> <span class="n">borderwidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">canvas</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">canvas</span><span class="p">.</span><span class="n">create_text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">sel_fg</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s">'w'</span><span class="p">)</span>

        <span class="n">canvas</span><span class="p">.</span><span class="n">bind</span><span class="p">(</span><span class="s">'&lt;Button-1&gt;'</span><span class="p">,</span> <span class="n">__canvas_forget</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="n">_calendar</span><span class="p">.</span><span class="n">bind</span><span class="p">(</span><span class="s">'&lt;Configure&gt;'</span><span class="p">,</span> <span class="n">__canvas_forget</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="n">_calendar</span><span class="p">.</span><span class="n">bind</span><span class="p">(</span><span class="s">'&lt;Button-1&gt;'</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">_pressed</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_build_calendar</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">year</span><span class="p">,</span> <span class="n">month</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">_date</span><span class="p">.</span><span class="n">year</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">_date</span><span class="p">.</span><span class="n">month</span>

        <span class="c1"># update header text (Month, YEAR)
</span>        <span class="n">header</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">_cal</span><span class="p">.</span><span class="n">formatmonthname</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># æ›´æ–°æ—¥å†æ˜¾ç¤ºçš„æ—¥æœŸ
</span>        <span class="n">cal</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">_cal</span><span class="p">.</span><span class="n">monthdayscalendar</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">indx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">_items</span><span class="p">):</span>
            <span class="n">week</span> <span class="o">=</span> <span class="n">cal</span><span class="p">[</span><span class="n">indx</span><span class="p">]</span> <span class="k">if</span> <span class="n">indx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">cal</span><span class="p">)</span> <span class="k">else</span> <span class="p">[]</span>
            <span class="n">fmt_week</span> <span class="o">=</span> <span class="p">[(</span><span class="s">'%02d'</span> <span class="o">%</span> <span class="n">day</span><span class="p">)</span> <span class="k">if</span> <span class="n">day</span> <span class="k">else</span> <span class="s">''</span> <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="n">week</span><span class="p">]</span>
            <span class="n">s</span><span class="p">.</span><span class="n">_calendar</span><span class="p">.</span><span class="n">item</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">fmt_week</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_show_select</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">bbox</span><span class="p">):</span>
        <span class="s">"""ä¸ºæ–°çš„é€‰æ‹©é…ç½®ç”»å¸ƒã€‚"""</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">bbox</span>

        <span class="n">textw</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">_font</span><span class="p">.</span><span class="n">measure</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

        <span class="n">canvas</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">_canvas</span>
        <span class="n">canvas</span><span class="p">.</span><span class="n">configure</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">height</span><span class="p">)</span>
        <span class="n">canvas</span><span class="p">.</span><span class="n">coords</span><span class="p">(</span><span class="n">canvas</span><span class="p">.</span><span class="n">text</span><span class="p">,</span> <span class="p">(</span><span class="n">width</span> <span class="o">-</span> <span class="n">textw</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">height</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">canvas</span><span class="p">.</span><span class="n">itemconfigure</span><span class="p">(</span><span class="n">canvas</span><span class="p">.</span><span class="n">text</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">)</span>
        <span class="n">canvas</span><span class="p">.</span><span class="n">place</span><span class="p">(</span><span class="n">in_</span><span class="o">=</span><span class="n">s</span><span class="p">.</span><span class="n">_calendar</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_pressed</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">evt</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">item</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">column</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">widget</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="s">"""åœ¨æ—¥å†çš„æŸä¸ªåœ°æ–¹ç‚¹å‡»ã€‚"""</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">item</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">widget</span> <span class="o">=</span> <span class="n">evt</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">evt</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">evt</span><span class="p">.</span><span class="n">widget</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">widget</span><span class="p">.</span><span class="n">identify_row</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="n">column</span> <span class="o">=</span> <span class="n">widget</span><span class="p">.</span><span class="n">identify_column</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">column</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">s</span><span class="p">.</span><span class="n">_items</span><span class="p">:</span>
            <span class="c1"># åœ¨å·¥ä½œæ—¥è¡Œä¸­å•å‡»æˆ–ä»…åœ¨åˆ—å¤–å•å‡»ã€‚
</span>            <span class="k">return</span>

        <span class="n">item_values</span> <span class="o">=</span> <span class="n">widget</span><span class="p">.</span><span class="n">item</span><span class="p">(</span><span class="n">item</span><span class="p">)[</span><span class="s">'values'</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">item_values</span><span class="p">):</span> <span class="c1"># è¿™ä¸ªæœˆçš„è¡Œæ˜¯ç©ºçš„ã€‚
</span>            <span class="k">return</span>

        <span class="n">text</span> <span class="o">=</span> <span class="n">item_values</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">column</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">text</span><span class="p">:</span> <span class="c1"># æ—¥æœŸä¸ºç©º
</span>            <span class="k">return</span>

        <span class="n">bbox</span> <span class="o">=</span> <span class="n">widget</span><span class="p">.</span><span class="n">bbox</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">bbox</span><span class="p">:</span> <span class="c1"># æ—¥å†å°šä¸å¯è§
</span>            <span class="n">s</span><span class="p">.</span><span class="n">master</span><span class="p">.</span><span class="n">after</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="k">lambda</span> <span class="p">:</span> <span class="n">s</span><span class="p">.</span><span class="n">_pressed</span><span class="p">(</span><span class="n">item</span> <span class="o">=</span> <span class="n">item</span><span class="p">,</span> <span class="n">column</span> <span class="o">=</span> <span class="n">column</span><span class="p">,</span> <span class="n">widget</span> <span class="o">=</span> <span class="n">widget</span><span class="p">))</span>
            <span class="k">return</span>

        <span class="c1"># æ›´æ–°ï¼Œç„¶åæ˜¾ç¤ºé€‰æ‹©
</span>        <span class="n">text</span> <span class="o">=</span> <span class="s">'%02d'</span> <span class="o">%</span> <span class="n">text</span>
        <span class="n">s</span><span class="p">.</span><span class="n">_selection</span> <span class="o">=</span> <span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="n">_show_select</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">bbox</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_prev_month</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="s">"""æ›´æ–°æ—¥å†ä»¥æ˜¾ç¤ºå‰ä¸€ä¸ªæœˆã€‚"""</span>
        <span class="n">s</span><span class="p">.</span><span class="n">_canvas</span><span class="p">.</span><span class="n">place_forget</span><span class="p">()</span>
        <span class="n">s</span><span class="p">.</span><span class="n">_selection</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="n">s</span><span class="p">.</span><span class="n">_date</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">_date</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="n">_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">_date</span><span class="p">.</span><span class="n">year</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">_date</span><span class="p">.</span><span class="n">month</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="n">CB_year</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">_date</span><span class="p">.</span><span class="n">year</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="n">CB_month</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">_date</span><span class="p">.</span><span class="n">month</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="n">_update</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_next_month</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="s">"""æ›´æ–°æ—¥å†ä»¥æ˜¾ç¤ºä¸‹ä¸€ä¸ªæœˆã€‚"""</span>
        <span class="n">s</span><span class="p">.</span><span class="n">_canvas</span><span class="p">.</span><span class="n">place_forget</span><span class="p">()</span>
        <span class="n">s</span><span class="p">.</span><span class="n">_selection</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="n">year</span><span class="p">,</span> <span class="n">month</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">_date</span><span class="p">.</span><span class="n">year</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">_date</span><span class="p">.</span><span class="n">month</span>
        <span class="n">s</span><span class="p">.</span><span class="n">_date</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">_date</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span>
            <span class="n">days</span><span class="o">=</span><span class="n">calendar</span><span class="p">.</span><span class="n">monthrange</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="n">_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">_date</span><span class="p">.</span><span class="n">year</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">_date</span><span class="p">.</span><span class="n">month</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="n">CB_year</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">_date</span><span class="p">.</span><span class="n">year</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="n">CB_month</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">_date</span><span class="p">.</span><span class="n">month</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="n">_update</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_update</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">event</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="s">"""åˆ·æ–°ç•Œé¢"""</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">and</span> <span class="n">event</span><span class="p">.</span><span class="n">keysym</span> <span class="o">!=</span> <span class="s">'Return'</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">CB_year</span><span class="p">.</span><span class="n">get</span><span class="p">())</span>
        <span class="n">month</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">CB_month</span><span class="p">.</span><span class="n">get</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">year</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">year</span> <span class="o">&gt;</span> <span class="mi">9999</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">s</span><span class="p">.</span><span class="n">_canvas</span><span class="p">.</span><span class="n">place_forget</span><span class="p">()</span>
        <span class="n">s</span><span class="p">.</span><span class="n">_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="n">_build_calendar</span><span class="p">()</span> <span class="c1"># é‡å»ºæ—¥å†
</span>
        <span class="k">if</span> <span class="n">year</span> <span class="o">==</span> <span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">year</span> <span class="ow">and</span> <span class="n">month</span> <span class="o">==</span> <span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">month</span><span class="p">:</span>
            <span class="n">day</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">day</span>
            <span class="k">for</span> <span class="n">_item</span><span class="p">,</span> <span class="n">day_list</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">_cal</span><span class="p">.</span><span class="n">monthdayscalendar</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">day</span> <span class="ow">in</span> <span class="n">day_list</span><span class="p">:</span>
                    <span class="n">item</span> <span class="o">=</span> <span class="s">'I00'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">_item</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="n">column</span> <span class="o">=</span> <span class="s">'#'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">day_list</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="n">day</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">s</span><span class="p">.</span><span class="n">master</span><span class="p">.</span><span class="n">after</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="k">lambda</span> <span class="p">:</span><span class="n">s</span><span class="p">.</span><span class="n">_pressed</span><span class="p">(</span><span class="n">item</span> <span class="o">=</span> <span class="n">item</span><span class="p">,</span> <span class="n">column</span> <span class="o">=</span> <span class="n">column</span><span class="p">,</span> <span class="n">widget</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">_calendar</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_exit</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">confirm</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
        <span class="s">"""é€€å‡ºçª—å£"""</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">confirm</span><span class="p">:</span> <span class="n">s</span><span class="p">.</span><span class="n">_selection</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">s</span><span class="p">.</span><span class="n">master</span><span class="p">.</span><span class="n">destroy</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_main_judge</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="s">"""åˆ¤æ–­çª—å£æ˜¯å¦åœ¨æœ€é¡¶å±‚"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1">#s.master ä¸º TK çª—å£
</span>            <span class="c1">#if not s.master.focus_displayof(): s._exit()
</span>            <span class="c1">#else: s.master.after(10, s._main_judge)
</span>
            <span class="c1">#s.master ä¸º toplevel çª—å£
</span>            <span class="k">if</span> <span class="n">s</span><span class="p">.</span><span class="n">master</span><span class="p">.</span><span class="n">focus_displayof</span><span class="p">()</span> <span class="o">==</span> <span class="bp">None</span> <span class="ow">or</span> <span class="s">'toplevel'</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">master</span><span class="p">.</span><span class="n">focus_displayof</span><span class="p">()):</span> <span class="n">s</span><span class="p">.</span><span class="n">_exit</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">s</span><span class="p">.</span><span class="n">master</span><span class="p">.</span><span class="n">after</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">_main_judge</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">s</span><span class="p">.</span><span class="n">master</span><span class="p">.</span><span class="n">after</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">_main_judge</span><span class="p">)</span>

        <span class="c1">#s.master.tk_focusFollowsMouse() # ç„¦ç‚¹è·Ÿéšé¼ æ ‡
</span>
    <span class="k">def</span> <span class="nf">selection</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="s">"""è¿”å›è¡¨ç¤ºå½“å‰é€‰å®šæ—¥æœŸçš„æ—¥æœŸæ—¶é—´ã€‚"""</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span><span class="p">.</span><span class="n">_selection</span><span class="p">:</span> <span class="k">return</span> <span class="bp">None</span>

        <span class="n">year</span><span class="p">,</span> <span class="n">month</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">_date</span><span class="p">.</span><span class="n">year</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">_date</span><span class="p">.</span><span class="n">month</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">_selection</span><span class="p">[</span><span class="mi">0</span><span class="p">])))[:</span><span class="mi">10</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">Input_judgment</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
        <span class="s">"""è¾“å…¥åˆ¤æ–­"""</span>
        <span class="c1"># å¦‚æœä¸åŠ ä¸Š==""çš„è¯ï¼Œå°±ä¼šå‘ç°åˆ ä¸å®Œã€‚æ€»ä¼šå‰©ä¸‹ä¸€ä¸ªæ•°å­—
</span>        <span class="k">if</span> <span class="n">content</span><span class="p">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="ow">or</span> <span class="n">content</span> <span class="o">==</span> <span class="s">""</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>



<span class="o">---</span>
<span class="c1">#åŸæœ‰å†…å®¹
</span>
<span class="n">window</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Tk</span><span class="p">()</span>
<span class="n">window</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'æ—¥ç¨‹ç®¡ç†'</span><span class="p">)</span>
<span class="n">window</span><span class="p">.</span><span class="n">geometry</span><span class="p">(</span><span class="s">"400x300"</span><span class="p">)</span>

</code></pre></div></div>

<p>å¦‚ä½ æ‰€è§ï¼Œè¿™é‡Œç›´æ¥æ–°å¢äº†å¤§æ¦‚250è¡Œä»£ç ï¼Œä½†ä½ ä¸éœ€è¦çŸ¥é“ä»–ä»¬åœ¨å¹²ä»€ä¹ˆã€‚æˆ‘ä¹Ÿæ˜¯ç›´æ¥å¤åˆ¶çš„ï¼Œæ¥æºæ˜¯<a href="https://blog.csdn.net/wodeyan001/article/details/86703034">è¿™ä¸ªå¤§ç¥çš„åšå®¢</a>ã€‚æˆ‘èƒ½çŸ¥é“ä»–åœ¨å¤§æ¦‚åšä»€ä¹ˆï¼Œä¹Ÿæ²¡æœ‰èŠ±æ—¶é—´å®Œå…¨çœ‹æ‡‚ã€‚ä½ å¯ä»¥æŠŠå®ƒä»¬ç†è§£ä¸ºè¿™äº›ä»£ç ç›¸å½“äºå†™äº†ä¸€ä¸ªåº“ï¼Œä½ å¯ä»¥ä»é‡Œé¢æ¥è°ƒç”¨ä¸€äº›å†…å®¹ã€‚</p>

<p><br /></p>

<p>å†™ç¨‹åºæœ‰æ—¶å€™å…¶å®å°±æ˜¯åœ¨ctrl cvï¼Œè§å¾—å¤šäº†å°±æ‡‚æ€ä¹ˆå†™äº†ã€‚åˆ«äººçš„ä¸œè¥¿å¯ä»¥ä¸ºæˆ‘æ‰€ç”¨ï¼Œæˆ‘å°±ç›´æ¥æ‹¿è¿‡æ¥ç”¨ï¼Œè¿™åœ¨å­¦ä¹ ç¼–ç¨‹æ—¶å¹¶ä¸æ˜¯ä»€ä¹ˆå¯è€»çš„æƒ³æ³•ï¼Œå½“ç„¶å‰ææ˜¯ä½ æ‰€æŠ„çš„é‚£ä¸ªäººæ˜¯æŠŠä»£ç å…¬å¼€å‡ºæ¥çš„ï¼Œè€Œä¸æ˜¯ä½ å»å‰½çªƒã€‚å¾ˆå¤šç¨‹åºå‘˜éƒ½ä¼šæŠŠè‡ªå·±å†™çš„ä¸œè¥¿å…¬å¼€ç»™å¤§å®¶ï¼Œä¾›åäººå­¦ä¹ ï¼Œè¿™ä¹Ÿæ˜¯äº’è”ç½‘å¼€æºç²¾ç¥ã€‚ä¹Ÿæ˜¯æˆ‘åœ¨è¿™é‡Œå†™è¿™ä¹ˆé•¿çš„æ–‡ç« ç»™å¤§å®¶çœ‹çš„æ ¹æœ¬åŸå› <del>ï¼Œè™½ç„¶ä¹Ÿä¸ºäº†åˆ†å§</del>ã€‚</p>

<p><strong>è¿è¡Œæ•ˆæœï¼š</strong></p>

<p>è¿™é‡Œä¸ä¼šè¾“å‡ºä»»ä½•ä¸œè¥¿ï¼Œä½ åªè¦æŠŠå®ƒä»¬å¤åˆ¶è¿›å»å³å¯ã€‚</p>

<h3 id="10å®Œå–„æ’å…¥ddlåŠŸèƒ½2">10.å®Œå–„æ’å…¥ddlåŠŸèƒ½2</h3>

<p>ç”±äºå‰é¢ç¬¬ä¹èŠ‚çš„ä»£ç å®åœ¨æ˜¯å¤ªé•¿äº†ï¼Œæˆ‘å°±æŠŠå‰©ä¸‹çš„ä»£ç åˆ†åˆ°äº†è¿™ä¸ªé‡Œé¢ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">---</span>
<span class="c1">#åŸæœ‰å†…å®¹
#è¯¦ç»†ä¿¡æ¯è¾“å…¥æ¡†
</span><span class="n">e2</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">tab2</span><span class="p">)</span>
<span class="n">e2</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="o">---</span>
<span class="c1">#ä¿®æ”¹å†…å®¹ï¼Œè¿™é‡ŒåŸå…ˆæœ‰ä¸€ä¸ªæ‰‹åŠ¨è¾“å…¥æ—¥æœŸçš„ddlè¾“å…¥æ¡†
</span>
<span class="c1">#ddlè¾“å…¥æ¡†
</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">window</span><span class="p">.</span><span class="n">winfo_screenwidth</span><span class="p">())</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">window</span><span class="p">.</span><span class="n">winfo_screenheight</span><span class="p">())</span><span class="o">/</span><span class="mi">2</span> <span class="c1">#æ— éœ€æŒæ¡
</span>
<span class="n">date_str</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">StringVar</span><span class="p">()</span> <span class="c1">#å®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²å˜é‡
</span><span class="n">date</span> <span class="o">=</span> <span class="n">ttk</span><span class="p">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">tab2</span><span class="p">,</span> <span class="n">textvariable</span> <span class="o">=</span> <span class="n">date_str</span><span class="p">)</span> <span class="c1">#æ”¾å…¥ä¸€ä¸ªæ˜¾ç¤ºæ¡†
</span><span class="n">date</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

<span class="c1">#è¿™äº›ä»£ç ï¼Œä½ ä¹Ÿä¸éœ€è¦æ˜ç™½æ¯ä¸€å¥çš„æ„æ€ï¼Œè¿™æ˜¯ä¸€ç§ç®€å†™æ–¹å¼
</span><span class="n">date_str_gain</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">[</span>   
    <span class="n">date_str</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Calendar</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="s">'ur'</span><span class="p">).</span><span class="n">selection</span><span class="p">()]</span> 
    <span class="k">if</span> <span class="n">date</span><span class="p">]</span>

<span class="c1">#ç®€å†™æ–¹å¼
</span><span class="n">tk</span><span class="p">.</span><span class="n">Button</span><span class="p">(</span><span class="n">tab2</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s">'é€‰æ‹©ddl'</span><span class="p">,</span> <span class="n">command</span> <span class="o">=</span> <span class="n">date_str_gain</span><span class="p">).</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="o">---</span>
<span class="c1">#åŸæœ‰å†…å®¹
#å¾…åŠç®¡ç†é¡µ
</span><span class="n">l1</span> <span class="o">=</span> <span class="n">tk</span><span class="p">.</span><span class="n">Label</span><span class="p">(</span><span class="n">tab2</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">"å¾…åŠåç§°ï¼š"</span><span class="p">)</span>
<span class="n">l1</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

</code></pre></div></div>

<p>è¿™é‡Œï¼Œæ›¿æ¢äº†åŸå…ˆçš„ddlé€‰æ‹©æ–¹å¼ï¼Œè€Œç”¨äº†å¼¹å‡ºæ¡†çš„æ–¹å¼æ¥é€‰æ‹©æ—¥æœŸï¼Œæ›´åŠ æ˜“äºä½¿ç”¨ã€‚</p>

<p><strong>åˆ°è¿™é‡Œï¼Œè¿™ç¯‡æ•™ç¨‹çš„ä»£ç éƒ¨åˆ†å°±ç»“æŸäº†ï¼</strong></p>

<p><strong>è¿è¡Œæ•ˆæœï¼š</strong></p>

<p><img src="..\images\2021-01-05-event-management\3-10.png" alt="img" /></p>

<h2 id="å››æ€»ç»“">å››ã€æ€»ç»“</h2>

<p>è¿™ç¯‡æ–‡ç« æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å†™æ•™ç¨‹ï¼Œå¦‚æœä½ èƒ½çœ‹æ‡‚çš„è¯ï¼Œé‚£æ‚¨å¯èƒ½çœŸçš„æ˜¯ç†è§£èƒ½åŠ›è¶…ç¾¤ã€‚</p>

<p>å¦‚æœå–œæ¬¢çš„è¯ï¼Œé‚£å°±è‡ªå·±è¯•è¯•ã€‚å¦‚æœå«Œä¸‘çš„è¯ï¼Œ<del>ä½ è‡ªå·±å†™å‘—</del>ä¹Ÿæ²¡ä»€ä¹ˆåŠæ³•ï¼Œæ¯•ç«Ÿtkinterå¹¶ä¸é€‚äºå†™GUIç•Œé¢ï¼Œå¦‚æœæƒ³è¦å®ƒå˜å¾—å¥½çœ‹çš„è¯ï¼Œå¯ä»¥å­¦ä¹ å…¶ä»–çš„åº“ï¼Œæˆ–è€…ç½‘é¡µå‰ç«¯ã€‚ä¸è¿‡tkinteræ°¸è¿œæ˜¯æœ€ç®€å•çš„é‚£ä¸ªã€‚å¦‚æœé‡åˆ°é—®é¢˜çš„è¯ï¼Œå…ˆæ£€æŸ¥ä¸€ä¸‹æœ‰æ²¡æœ‰å°‘å¤åˆ¶å‡ è¡Œä»£ç ï¼Œå¦‚æœç¡®è®¤æ²¡æœ‰çš„è¯å°±è¯·è¯„è®ºå‘Šè¯‰æˆ‘ï¼Œ<del>æˆ‘ä¹Ÿä¸ä¿è¯ä¸€å®šæœ‰æ—¶é—´æ¥æ”¹</del>ã€‚</p>

<p>å°±å†™è¿™ä¹ˆå¤šäº†ï¼Œæˆ‘æ˜¯Mr.Zhangã€‚</p>

:ET